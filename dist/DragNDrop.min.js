angular.module("DragNDrop",[]).directive("listDrag",["ListDrag",function(e){return{link:function(t,n,a){e.registerElem(n[0]),"model"in a&&e.registerObject(n[0],a.model)}}}]).service("ListDrag",[function(){var e,t,n,a=new MutationObserver(function(...e){m(),s.forEach(function(e){e.setAttribute("draggable",!0),e.removeEventListener("dragstart",l),e.addEventListener("dragstart",l)})}),r=null,i=null,o=null,s=[],d=null,c=null;function l(n){c=n.target,t=c.index,function(e){var t=new Image;t.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=",e.dataTransfer.setDragImage(t,0,0)}(n),e=c.getBoundingClientRect().height/2,function(t){(d=t.target.cloneNode(!0)).classList.add("clone"),d.style.top=t.target.pageY+e+"px",r.appendChild(d)}(n),g(n),c.classList.add("ghost"),c.addEventListener("drag",g),c.addEventListener("dragend",v),document.addEventListener("dragenter",u),document.addEventListener("dragover",A)}function g(t){i=r.getBoundingClientRect(),d.style.top=t.pageY-i.top-e+"px",d.getBoundingClientRect().top>i.bottom&&r.appendChild(c)}function u(e){e.target.parentElement!==r||e.target.classList.contains("ghost")||e.target.insertAdjacentElement("beforebegin",c)}function v(e){d.remove(),c.classList.remove("ghost"),c.classList.add("pulse"),setTimeout(function(){c.classList.remove("pulse")},2e3),document.removeEventListener("dragenter",u),document.removeEventListener("dragover",A);var a,i,s,l,g,v,p,f=t;m(),f!=c.index&&(a=c.index,s=f,l=a,g=[],v=(i=o).splice(s,1),p=i.splice(0,l),o=g=(g=(g=g.concat(p)).concat(v)).concat(i),angular.element(r).scope()[n]=o,r.dispatchEvent(new CustomEvent("listupdated",{detail:{newValue:c.index,oldValue:f}})))}function m(){(s=Array.from(r.children)).forEach(function(e,t){e.index=t})}function A(e){e.preventDefault(),e.stopPropagation()}this.registerElem=function(e){r=e,a.observe(r,p)},this.registerObject=function(e,t){n=t,o=angular.element(e).scope()[t]};var p={childList:!0}}]);